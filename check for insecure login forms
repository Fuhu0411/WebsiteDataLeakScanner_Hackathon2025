import requests 
from bs4 import BeautifulSoup
from urllib.parse import urljoin

def check_insecure_login_forms(url):
    try:
        response = requests.get(url)
        response.raise_for_status()  # Ensure the request was successful
    except requests.exceptions.RequestException as e:
        print(f"❌ Error fetching URL: {e}")
        return

    soup = BeautifulSoup(response.text, 'html.parser')
    forms = soup.find_all('form')

    for form in forms:
        action = form.get('action')
        full_action_url = urljoin(url, action) if action else url  # Handle relative URLs

        # Check if a password field exists in the form
        has_password_field = any(input_tag.get('type') == 'password' for input_tag in form.find_all('input'))

        # If form contains a password field and uses HTTP, print a warning
        if has_password_field and full_action_url.startswith('http://'):
            print(f"⚠️ Insecure login form detected!\n   - Form action: {full_action_url}\n   - Site: {url}")

if __name__ == "__main__":
    target_url = input("Enter website URL to scan: ")  # Example: http://example.com
    check_insecure_login_forms(target_url)
